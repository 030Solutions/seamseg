# Seamless Scene Segmentation

<p align="center">
<img src="network.png" width="70%"/>
<br>
<a href="http://openaccess.thecvf.com/content_CVPR_2019/html/Porzi_Seamless_Scene_Segmentation_CVPR_2019_paper.html">CVPR</a>
|
<a href="https://arxiv.org/abs/1905.01220">arXiv</a>
</p>

Seamless Scene Segmentation is a CNN-based architecture that can be trained end-to-end to predict a complete class- and
instance-aware labeling of each pixel in an image. To tackle this task, also known as "panoptic segmentation", we take
advantage of a novel segmentation head that seamlessly integrates multi-scale features generated by a Feature Pyramid
Network with contextual information conveyed by a light-weight DeepLab-like module.

This repository will contain training and evaluation Pytorch code, based on our re-implementation of the Mask R-CNN
framework, as well as pre-trained models to reproduce the Mapillary Vistas results from our paper.

If you use Seamless Scene Segmentation in your research, please cite:
```bibtex
@inProceedings{porzi2019seamless,
  author    = {Porzi, Lorenzo and Rota Bul\`o, Samuel and Colovic, Aleksander and Kontschieder, Peter},
  title     = {Seamless Scene Segmentation},
  booktitle = {Computer Vision and Pattern Recognition (CVPR)},
  year      = {2019},
  month     = {June}
}
```

## Requirements and setup

To install PyTorch, please refer to https://github.com/pytorch/pytorch#installation.

**IMPORTANT NOTE**: our code _requires_ Pytorch v1.1.0 or newer, and has only been tested with v1.1.0. We do not
guarantee compatibility with any other version, nor will provide support for it.

To install all other dependencies using pip:
```bash
pip install -r requirements.txt
```

Some parts of this code have native CUDA implementations, which are compiled using Pytorch's native extension mechanism,
which requires a package called `ninja`.
This can easy be installed from most distributions' package managers, _e.g._ in Ubuntu derivatives:
```bash
sudo apt-get install ninja-build
```
In case PyTorch is installed via conda, `ninja` will be automatically installed too.

Finally, to compile and install our code:
```bash
python setup.py install
```